# 🎙️ 礼明老师语音克隆配置指南

## 概述

本系统支持语音克隆功能，可以让AI用礼明老师的真实声音进行回复。目前支持ElevenLabs、Azure Speech Services和讯飞语音三个平台。

## 🚀 推荐方案：ElevenLabs

### 优势
- 语音质量最高，接近真人水平
- 只需3-5分钟的语音样本
- 支持中文语调和情感表达
- API简单易用

### 配置步骤

#### 1. 注册ElevenLabs账号
1. 访问 [https://elevenlabs.io](https://elevenlabs.io)
2. 点击"Sign Up"注册账号
3. 验证邮箱并登录

#### 2. 获取API Key
1. 登录后点击右上角头像
2. 选择"Profile"
3. 点击"API Keys"标签
4. 复制API Key（sk-开头的长字符串）

#### 3. 在系统中配置
1. 启动服务器：`npm start`
2. 访问 http://localhost:3000
3. 点击"语音设置"按钮
4. 选择"ElevenLabs"平台
5. 输入API Key并保存

#### 4. 准备语音样本
**要求：**
- 清晰的中文语音，无背景噪音
- 时长3-10分钟为佳
- 包含多种语调和情感
- 支持格式：MP3, WAV, M4A

**建议内容：**
- 朗读一段课文或文章
- 包含问候、解释、鼓励等不同语调
- 避免单调的阅读，要有自然的语音变化

#### 5. 创建语音克隆
1. 在语音设置页面上传音频文件
2. 点击"创建语音克隆"按钮
3. 等待处理完成（通常需要几分钟）
4. 系统会自动保存新创建的语音ID

#### 6. 测试语音效果
1. 在测试区域输入文本
2. 点击"生成语音"按钮
3. 播放生成的音频，检查效果

## 💰 费用说明

### ElevenLabs价格
- **免费额度**：每月10,000字符
- **Starter计划**：$5/月，30,000字符
- **Creator计划**：$22/月，100,000字符
- **Pro计划**：$99/月，500,000字符

### 使用建议
- 对于个人学习使用，免费额度通常足够
- 如果需要大量使用，建议升级到付费计划

## 🔧 技术实现

### 后端API
```javascript
// 语音合成
POST /api/text-to-speech
{
  "text": "要转换的文本",
  "voiceId": "语音ID(可选)"
}

// 语音配置
POST /api/voice-config
{
  "platform": "elevenlabs",
  "elevenlabsKey": "your-api-key"
}

// 创建语音克隆
POST /api/create-voice
FormData: {
  voiceName: "礼明老师",
  voiceDescription: "语音描述",
  voiceSamples: [语音文件数组]
}
```

### 前端集成
语音播放功能已集成到对话系统中：
1. 用户发送消息后，AI回复会自动使用克隆的声音
2. 如果语音克隆不可用，会回退到系统TTS
3. 可以通过语音按钮开启/关闭语音功能

## 🛠️ 其他平台配置

### Azure Speech Services
1. 访问 [Azure Portal](https://portal.azure.com)
2. 创建"Speech Services"资源
3. 获取订阅密钥和区域信息
4. 在系统中选择Azure平台并配置

### 讯飞语音
1. 访问 [讯飞开放平台](https://www.xfyun.cn)
2. 注册并创建应用
3. 获取AppID、API Secret和API Key
4. 在系统中选择讯飞平台并配置

## 🔍 故障排除

### 常见问题

**1. API Key无效**
- 检查API Key是否正确复制
- 确认账号是否有足够的额度
- 检查网络连接是否正常

**2. 语音生成失败**
- 检查文本是否过长（建议500字符以内）
- 确认语音克隆是否创建成功
- 查看浏览器控制台的错误信息

**3. 语音文件无法播放**
- 检查浏览器是否支持音频播放
- 确认没有被广告拦截器阻止
- 尝试刷新页面重新加载

**4. 语音克隆质量不佳**
- 提供更长时间的语音样本
- 确保录音质量清晰无噪音
- 包含更多语调变化

### 网络问题
**ElevenLabs需要科学上网访问：**
- 如果无法访问，建议使用Azure或讯飞语音
- 或配置合适的网络代理

## 📊 使用统计

系统会记录：
- 语音合成调用次数
- API使用量统计
- 语音克隆创建记录

可在管理后台查看详细统计信息。

## 🔒 安全说明

**API密钥安全：**
- API Key存储在服务器本地，不会上传到云端
- 建议定期更换API Key
- 不要在公共场所输入API Key

**语音数据：**
- 上传的语音样本仅用于训练
- 可以随时在ElevenLabs平台删除语音模型
- 建议使用专门录制的语音样本

## 🎯 最佳实践

1. **语音样本准备**
   - 在安静环境录制
   - 使用质量好的麦克风
   - 录制自然对话而非朗读

2. **成本控制**
   - 监控API使用量
   - 合理设置语音长度限制
   - 优先使用免费额度

3. **用户体验**
   - 提供语音开关选项
   - 设置合理的语音播放速度
   - 在网络较慢时回退到系统TTS

## 📞 技术支持

如果遇到问题，可以：
1. 查看浏览器控制台错误信息
2. 检查服务器日志
3. 参考ElevenLabs官方文档
4. 联系技术支持

---

通过以上配置，您就可以让礼明老师的智能体用真实的声音与学生对话了！🎉 