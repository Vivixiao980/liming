<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>语音克隆指导 - 礼明老师</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .guide-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-heavy);
        }
        
        .guide-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--secondary-color);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-color);
        }
        
        .checklist {
            list-style: none;
            padding: 0;
        }
        
        .checklist li {
            padding: 0.5rem 0;
            display: flex;
            align-items: center;
        }
        
        .checklist li::before {
            content: "✅";
            margin-right: 0.5rem;
            font-size: 1.2rem;
        }
        
        .sample-script {
            background: #f8fafc;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            font-family: 'Georgia', serif;
            line-height: 1.6;
        }
        
        .recording-tips {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            color: #92400e;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        
        .tech-specs {
            background: #e0f2fe;
            border: 1px solid #0891b2;
            color: #0c4a6e;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        
        .record-button {
            background: #dc2626;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            margin: 1rem;
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
            transition: all 0.3s ease;
        }
        
        .record-button:hover {
            background: #b91c1c;
            transform: translateY(-2px);
        }
        
        .record-button.recording {
            background: #22c55e;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }
        
        .audio-player {
            width: 100%;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <div class="guide-container">
        <a href="/minimax-voice-setup.html" class="back-link">
            <i class="fa fa-arrow-left"></i>
            返回MiniMax语音设置
        </a>
        
        <div class="upload-header">
            <h1>🎙️ 礼明老师语音克隆指导</h1>
            <p>创建高质量的语音克隆，让AI用您的真实声音说话</p>
        </div>

        <!-- 录音要求 -->
        <div class="guide-section">
            <h2>📋 录音要求清单</h2>
            <ul class="checklist">
                <li>安静的录音环境，无背景噪音</li>
                <li>使用质量良好的麦克风</li>
                <li>录音时长3-10分钟</li>
                <li>包含多种语调和情感</li>
                <li>清晰的普通话发音</li>
                <li>自然的语速，不要过快或过慢</li>
                <li>避免咳嗽、停顿过长等干扰</li>
            </ul>
        </div>

        <!-- 技术规格 -->
        <div class="guide-section">
            <h2>🔧 技术规格</h2>
            <div class="tech-specs">
                <strong>推荐设置：</strong><br>
                • 格式：MP3 或 WAV<br>
                • 采样率：44.1kHz 或更高<br>
                • 比特率：128kbps 或更高<br>
                • 单声道或立体声均可<br>
                • 文件大小：每个文件不超过50MB
            </div>
        </div>

        <!-- 录音内容建议 -->
        <div class="guide-section">
            <h2>📝 录音内容建议</h2>
            <p>以下是一份示例脚本，您可以参考录制：</p>
            
            <div class="sample-script">
                <h3>礼明老师介绍</h3>
                <p>你好，我是礼明，打过胜仗、愿意分享。我很高兴能在这里与大家交流。在我的职业生涯中，我经历了许多挑战和机遇，也积累了不少经验和感悟。</p>
                
                <h3>教学理念</h3>
                <p>我认为学习最重要的是要有好奇心和坚持不懈的精神。每个人都有自己的学习方式，关键是要找到适合自己的方法。遇到困难时，不要轻易放弃，要相信自己的能力。</p>
                
                <h3>鼓励话语</h3>
                <p>记住，成功不是一蹴而就的，而是通过不断的努力和坚持实现的。每一次的失败都是成长的机会，每一次的尝试都让我们更接近目标。相信自己，你一定可以做到！</p>
                
                <h3>日常对话</h3>
                <p>最近怎么样？学习上有什么新的收获吗？如果遇到什么问题，随时可以来找我讨论。我们一起来解决这些挑战，让学习变得更加有趣和有意义。</p>
            </div>
            
            <div class="recording-tips">
                <strong>💡 录音技巧：</strong><br>
                • 用自然的语调朗读，不要机械化<br>
                • 在不同句子间加入适当的停顿<br>
                • 表达不同的情感：热情、鼓励、思考<br>
                • 可以加入一些口语化的表达<br>
                • 如果读错了，停顿后重新开始那一句
            </div>
        </div>

        <!-- 在线录音工具 -->
        <div class="guide-section">
            <h2>🎤 在线录音工具</h2>
            <p>您可以直接在浏览器中录制语音样本：</p>
            
            <div style="text-align: center; margin: 2rem 0;">
                <button class="record-button" onclick="toggleRecording()" id="recordBtn">
                    <i class="fa fa-microphone"></i> 开始录音
                </button>
                <div id="recordingTime" style="margin-top: 1rem; font-size: 1.2rem; font-weight: bold; display: none;">
                    录音时间: <span id="timeDisplay">00:00</span>
                </div>
            </div>
            
            <audio id="recordedAudio" class="audio-player" controls style="display: none;"></audio>
            
            <div id="recordingStatus" style="margin-top: 1rem; text-align: center;"></div>
        </div>

        <!-- 质量检查 -->
        <div class="guide-section">
            <h2>✅ 质量检查</h2>
            <p>录音完成后，请检查以下几点：</p>
            <ul class="checklist">
                <li>音量适中，不会过小或过大</li>
                <li>没有明显的背景噪音</li>
                <li>语音清晰，没有模糊不清的地方</li>
                <li>包含了多种语调和情感</li>
                <li>总时长在3-10分钟之间</li>
            </ul>
        </div>

        <!-- 上传步骤 -->
        <div class="guide-section">
            <h2>🚀 上传和创建</h2>
            <p>录音完成后，您可以：</p>
            <ol>
                <li>返回语音设置页面</li>
                <li>上传您录制的音频文件</li>
                <li>点击"创建语音克隆"</li>
                <li>等待处理完成（通常需要几分钟）</li>
                <li>测试语音效果</li>
            </ol>
            
            <div style="text-align: center; margin-top: 2rem;">
                <a href="/minimax-voice-setup.html" class="upload-voice" style="text-decoration: none; display: inline-block;">
                    <i class="fa fa-arrow-right"></i> 前往MiniMax语音设置
                </a>
            </div>
        </div>
    </div>

    <script>
        let mediaRecorder;
        let recordedChunks = [];
        let startTime;
        let timerInterval;

        async function toggleRecording() {
            const recordBtn = document.getElementById('recordBtn');
            const recordingTime = document.getElementById('recordingTime');
            const timeDisplay = document.getElementById('timeDisplay');
            const recordedAudio = document.getElementById('recordedAudio');
            const recordingStatus = document.getElementById('recordingStatus');

            if (mediaRecorder && mediaRecorder.state === 'recording') {
                // 停止录音
                mediaRecorder.stop();
                recordBtn.innerHTML = '<i class="fa fa-microphone"></i> 开始录音';
                recordBtn.classList.remove('recording');
                recordingTime.style.display = 'none';
                clearInterval(timerInterval);
                
                recordingStatus.innerHTML = '<div style="color: #059669;">录音已停止，正在处理...</div>';
            } else {
                // 开始录音
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        audio: {
                            echoCancellation: true,
                            noiseSuppression: true,
                            sampleRate: 44100
                        } 
                    });
                    
                    recordedChunks = [];
                    mediaRecorder = new MediaRecorder(stream, {
                        mimeType: 'audio/webm;codecs=opus'
                    });

                    mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            recordedChunks.push(event.data);
                        }
                    };

                    mediaRecorder.onstop = () => {
                        const blob = new Blob(recordedChunks, { type: 'audio/webm' });
                        const audioUrl = URL.createObjectURL(blob);
                        recordedAudio.src = audioUrl;
                        recordedAudio.style.display = 'block';
                        
                        // 创建下载链接
                        const downloadLink = document.createElement('a');
                        downloadLink.href = audioUrl;
                        downloadLink.download = `礼明老师语音样本_${new Date().toISOString().slice(0,19).replace(/:/g,'-')}.webm`;
                        downloadLink.innerHTML = '<i class="fa fa-download"></i> 下载录音文件';
                        downloadLink.style.cssText = 'display: inline-block; margin: 1rem; padding: 0.5rem 1rem; background: #6366f1; color: white; text-decoration: none; border-radius: 8px;';
                        
                        recordingStatus.innerHTML = '<div style="color: #059669;">✅ 录音完成！请试听并下载文件。</div>';
                        recordingStatus.appendChild(downloadLink);
                        
                        // 停止所有音轨
                        stream.getTracks().forEach(track => track.stop());
                    };

                    mediaRecorder.start();
                    startTime = Date.now();
                    
                    recordBtn.innerHTML = '<i class="fa fa-stop"></i> 停止录音';
                    recordBtn.classList.add('recording');
                    recordingTime.style.display = 'block';
                    
                    // 开始计时
                    timerInterval = setInterval(() => {
                        const elapsed = Math.floor((Date.now() - startTime) / 1000);
                        const minutes = Math.floor(elapsed / 60);
                        const seconds = elapsed % 60;
                        timeDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    }, 1000);
                    
                    recordingStatus.innerHTML = '<div style="color: #0891b2;">🎙️ 正在录音中，请按照示例脚本自然朗读...</div>';
                    
                } catch (error) {
                    console.error('录音失败:', error);
                    recordingStatus.innerHTML = '<div style="color: #dc2626;">❌ 无法访问麦克风，请检查浏览器权限设置</div>';
                }
            }
        }

        // 页面加载时检查麦克风权限
        window.onload = function() {
            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(() => {
                    document.getElementById('recordingStatus').innerHTML = '<div style="color: #059669;">✅ 麦克风权限已获取，可以开始录音</div>';
                })
                .catch(() => {
                    document.getElementById('recordingStatus').innerHTML = '<div style="color: #f59e0b;">⚠️ 请允许浏览器访问麦克风以使用录音功能</div>';
                });
        };
    </script>
</body>
</html> 